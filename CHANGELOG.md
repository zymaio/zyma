# 更新日志 (Changelog)

本项所有显著更新都将记录在此文件中。

## [Unreleased]

### 🚀 架构大重塑：极致解耦与 IDE 能力进阶
本次更新完成了自项目成立以来最深度的架构调整，将 Zyma 彻底转变为一个通用的、高性能的插件化宿主平台。

#### 🧩 标准化插件 API (v1.0)
- **对标 VS Code**: 为插件注入了全新的 `zyma` 全局对象，支持 `workspace`, `system`, `window`, `views` 四大命名空间。
- **高性能搜索 (`findFiles`)**: 由 Rust 侧 `globset` + `walkdir` 驱动，支持毫秒级的全局 Glob 模式文件查找。
- **文件实时监听 (`watch`)**: 集成 Rust `notify` 引擎，支持插件实时感知文件系统变动（增删改）。
- **外部命令执行 (`exec`)**: 允许插件安全地调用系统二进制程序（如 Python, Git），并捕获实时输出。

#### 📊 智能输出系统 (Output Console)
- **按需激活逻辑**: 革命性的“幽灵式”设计，默认完全隐藏，仅在有日志输出时自动浮现 `Monitor` 图标。
- **独立窗口调度**: 支持将任意日志频道（Channel）一键弹出为独立的原生窗口，实现多屏实时监控。
- **语法高亮**: 自动识别并染色不同级别的日志（Error, Warning, Success, Info），极大提升信息阅读效率。

#### 🛠️ 模块化深度优化
- **前端逻辑解耦**: `App.tsx` 实现“逻辑归位”，初始化流程剥离至 `useAppInitialization` 钩子，布局拆分为 `ActivityBar` 和 `StatusBar` 等独立组件。
- **后端模块拆分**: `lib.rs` 瘦身，重构命令分发机制；将文件操作、搜索、监听和输出逻辑独立为专门的 Rust 模块。
- **统一状态管理**: 引入全局 `AppState` 结构体，通过 Tauri `State` 统一调度跨模块数据流。

#### 💄 体验与稳定性修复
- **布局抖动修复**: 彻底解决了在设置面板调整 UI 字体大小时，由于面板自身缩放导致的界面剧烈跳动问题。
- **Windows 路径深度兼容**: 修复了由于 Windows 长路径前缀（`\\?\`）导致的插件文件读取权限冲突。
- **联动关闭逻辑**: 实现了主窗口与独立日志窗口的有序联动关闭，消除了 WebView2 退出时的资源竞争报错。

## [0.9.5] - 2026-01-24

### 🚀 自动更新系统与工业级稳定性加固
此版本标志着 Zyma 具备了完整的生命周期管理能力，通过集成官方更新插件和重构底层 IO 逻辑，系统健壮性大幅提升。

#### ✨ 核心功能：全自动在线更新
- **多镜像分发**: 集成 `tauri-plugin-updater`，配置 GitHub 与 Gitee 双端点，确保国内用户也能极速升级。
- **安全签名**: 引入 Ed25519 数字签名校验，确保更新包的来源真实可靠。
- **非侵入式提示**: 状态栏右下角增加静默更新标记（小绿点），避免弹窗打断工作流。支持点击版本号一键安装并自动重启。

#### 🛠️ 性能与体验优化
- **编辑器懒加载**: 重构 `Editor.tsx`，将 20+ 种语言解析包改为动态导入。仅在打开对应文件时加载，显著降低初始内存占用。
- **高性能并行搜索**: 使用 `ignore` (ripgrep核心) 和 `num_cpus` 库重构搜索后端。支持多线程并行扫描，并自动尊重 `.gitignore` 设置。
- **路径标准化**: 彻底解决 Windows 环境下由于路径大小写、斜杠不统一导致的“重复标签页”和“切换失效”等顽固 Bug。
- **安全防护**: 后端增加 5MB 文件读取上限，防止因意外打开超大日志文件导致的 UI 假死。

#### 🧹 代码与架构清理
- **移除死代码**: 删除了未启用的 AI 窗口占位代码，保持核心库轻量纯净。
- **动态版本联动**: 状态栏版本号与 `Cargo.toml` 实时同步，消除硬编码。
- **监听器泄露修复**: 重构 `App.tsx` 生命周期，引入初始化锁，彻底杜绝异步监听器导致的竞态冲突。

## [0.9.4] - 2026-01-23

### 🚀 VS Code 核心复刻与 AI Ready 架构升级
这是 Zyma 迈向专业 IDE 的重要里程碑版本，建立了高度解耦的插件化架构，并全面支持 AI Agent 零修改接入。

#### ✨ 核心特性复刻
- **命令系统 (Command Palette)**: 实现了标准的命令注册中心与 `Ctrl+Shift+P` 快捷搜索面板，支持全系统功能检索。
- **全局搜索重构**: 全局搜索结果现在按文件路径分组显示，支持点击跳转至具体行号，体验完全对齐 VS Code。
- **动态视图系统**: 侧边栏支持通过 `ViewRegistry` 动态注册面板，Activity Bar 自动映射图标。
- **编辑器搜索 (Ctrl+F)**: 复刻了右上角浮动搜索框，支持大小写、全字及正则模式，彻底屏蔽原生简陋 UI。
- **可调节侧边栏**: 实现可拖拽调整宽度的侧边栏，支持 `Ctrl+B` 一键隐藏/显示。
- **标签页增强**: 补全了标签页右键菜单（关闭左侧、关闭右侧、关闭其他等），并支持根据上下文动态禁用选项。
- **路径面包屑**: 顶部实时显示文件路径导航；状态栏增加光标位置、编码、语言模式及未保存标记。

#### 🧩 插件系统与 AI 接入能力
- **AI 窗口 API**: 注入 `zyma.window.create`，允许插件创建独立的专用悬浮窗口。
- **纯净渲染模式 (Clean Mode)**: 辅助窗口不再加载编辑器核心，仅作为插件挂载点，避免资源浪费。
- **Workspace API**: 插件获得完整的文件系统读写权限，为 AI 的工程感知（RAG）打下基础。
- **零修改接入**: AI 功能可作为独立插件运行，无需触碰 Zyma 核心源码。

#### 💄 UI/UX 与 性能优化
- **界面字号全局联动**: 设置面板新增“界面字体大小”，实现全系统 UI（侧边栏、弹窗、菜单）统一缩放。
- **专业图标系统**: 资源管理器现在能识别 `.rs`, `.ts`, `.json` 等多种格式并显示特定彩色图标。
- **性能飞跃**: 通过 `React.memo` 节点级隔离和自定义比较算法，彻底解决了万级文件树下的点击延迟问题。
- **后端搜索加速**: 增加 target/dist 目录过滤及文件大小限制，防止搜索时出现 IO 卡死。

#### 🛠️ 架构改进
- **极致模块化**: `App.tsx` 逻辑重构至 `useFileManagement` Hook；`i18n` 资源分离至 JSON 独立文件。
- **稳定性增强**: 使用 `window.destroy()` 彻底解决退出时的循环拦截 Bug；引入 `ErrorBoundary` 错误边界。

## [0.9.3] - 2026-01-13
- (内容略)
