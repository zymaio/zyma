明白了，我把之前的完整功能文档更新成**最终版**，把 **跨平台、Tauri 技术栈、阶段开发计划、在线升级、插件市场** 都加上，适合直接喂给 Agent 或开发团队。

---

# 智码（zyma）功能文档（完整版 v0-v1-v1.5）

> **定位**：插件驱动 IDE，但无插件状态下为开箱即用的 Notepad 替代器
> **目标**：开箱即用 + 大文件稳定 + 代码彩色显示 + Markdown 预览 + 主题切换 + 插件扩展
> **跨平台**：Windows、macOS、Linux
> **技术栈**：
>
> * **内核**：Rust
> * **跨平台 UI / 前端**：Tauri + HTML/JS/TypeScript + CodeMirror 6
> * **插件**：JS/TS / WASM / Rust
> * **在线升级**：Tauri Updater / 差分包 / 安全签名

---

## 1️⃣ 核心内核功能（Notepad 替代器）

| 功能类别        | 功能点                  | 描述                          | 优先级 | 跨平台要求                                |
| ----------- | -------------------- | --------------------------- | --- | ------------------------------------ |
| 文件操作        | 打开 / 保存 / 另存为        | 单文件、多文件（Tabs）               | ⭐⭐⭐ | 支持 Windows / macOS / Linux 路径、编码、换行符 |
| 文件大小支持      | 超大文件                 | Chunk 分块读取，支持百万行文本 / GB 日志  | ⭐⭐⭐ | √                                    |
| 编码支持        | UTF-8 / GBK / ANSI 等 | 自动探测编码并正确显示                 | ⭐⭐⭐ | √                                    |
| 编辑功能        | 基本编辑                 | 插入、删除、剪切、复制、撤销、重做           | ⭐⭐⭐ | √                                    |
| 界面显示        | Tabs                 | 多文件切换                       | ⭐⭐⭐ | √                                    |
| 界面显示        | 行号 / 折行              | 支持行号显示和自动折行                 | ⭐⭐  | √                                    |
| 界面显示        | 基础语法高亮               | CodeMirror 6 内置支持，按文件扩展名高亮  | ⭐⭐⭐ | √                                    |
| 搜索          | 文本搜索                 | 当前文件搜索、替换                   | ⭐⭐  | √                                    |
| 状态栏         | 文件信息                 | 显示编码、行数、列数、文件大小             | ⭐   | √                                    |
| 系统集成        | 文件关联                 | 可设置默认打开方式替代 Notepad         | ⭐   | 各平台文件关联与默认程序替换                       |
| 主题显示        | 浅色 / 深色主题            | 内核自带主题切换                    | ⭐⭐⭐ | √                                    |
| Markdown 支持 | 编辑 + 预览              | 内核渲染 Markdown，支持 Split View | ⭐⭐⭐ | √                                    |
| **插件系统**    | 加载 / 管理 / API / 生命周期 | 内核提供插件接口，支持功能扩展             | ⭐⭐⭐ | √                                    |
| **在线升级**    | 自动检查 / 下载更新          | v1 规划，保证内核快速更新              | ⚠️  | √                                    |
| **插件市场**    | 浏览 / 安装 / 更新插件       | v1.5 规划，支持插件生态              | ⚠️  | √                                    |

---

## 2️⃣ 代码彩色显示设计

* 内核自动识别常见编程语言
* 支持大文件，虚拟滚动渲染
* 支持主题切换（浅色 / 深色）
* 可通过插件扩展更多语言或语义高亮

**支持语言示例**：

* C / C++ / Python / Java / Go / Rust / JavaScript / TypeScript / JSON / XML / HTML / CSS / Shell

**技术方案**：

* CodeMirror 6 编辑器 + 内置语言模式
* 文件扩展名自动识别语言
* 虚拟滚动 + chunk 渲染大文件

---

## 3️⃣ Markdown 编辑与预览

**内核功能**：

* Markdown 文件自动高亮
* 内置 Markdown 预览面板
* 实时预览（debounce 渲染）
* Split View 支持编辑区 + 预览区
* 主题支持，预览可随编辑器主题切换

**插件扩展**：

* Mermaid / LaTeX / TOC / 脚注 / 表格 / 双向滚动

---

## 4️⃣ 插件系统设计（独立文档概述）

* **定位**：扩展 IDE 功能，但不破坏内核稳定性
* **生命周期**：install → init → activate → deactivate → uninstall
* **架构**：

```
Plugin Layer
    │
    ▼
Stable Plugin API
    │
    ▼
Editor Core (Rust 内核)
    │ ──────────> 文件操作 + 高亮 + Markdown + 主题
Platform Layer (Tauri / OS / FS)
```

* **API 模块**：

  * EditorCore（文件、Tabs、Buffer 操作）
  * MarkdownRenderer（渲染增强）
  * ThemeManager（主题注册与切换）
  * EventSystem（文件、光标、主题事件）
  * Messaging / IPC（插件通信）

* **运行隔离**：每个插件独立沙箱运行，异常捕获

* **管理界面**：插件启用 / 停用 / 卸载 / 查看信息

---

## 5️⃣ 在线升级（v1 功能）

* **目标**：用户内核自动升级，保证快速迭代

* **功能点**：

  * 检查最新版本
  * 下载差分补丁或完整安装包
  * 安全验证（签名 / 哈希）
  * 升级过程中保护用户数据

* **实现方式**：

  * 后端接口提供最新版本信息
  * 内核调用下载和升级接口
  * Tauri 支持跨平台升级

---

## 6️⃣ 插件市场（v1.5 功能）

* **目标**：建立官方插件生态
* **功能点**：

  * 浏览 / 下载 / 安装 / 更新插件
  * 分类（Markdown / 主题 / AI / 语言服务 / 调试 / Git）
  * 插件评分与评论
  * 插件兼容性验证
* **实现方式**：

  * 后端托管插件包
  * 插件需提供 manifest.json 保证兼容
  * 插件可在线更新与卸载

---

## 7️⃣ 用户体验原则

1. **首次启动**：秒开文件、默认主题、Tabs、多文件、Markdown 预览
2. **默认体验**：Notepad 替代器状态，无需插件即可用
3. **插件体验**：可选安装插件扩展 IDE 功能
4. **阶段性升级**：

   * v1：在线升级
   * v1.5：插件市场

---

## 8️⃣ 开发阶段规划（v0-v1-v1.5）

| 阶段       | 内核功能                                       | 插件功能                   | 在线升级 / 插件市场 | 技术栈                         |
| -------- | ------------------------------------------ | ---------------------- | ----------- | --------------------------- |
| **v0**   | 文件操作 + Tabs + 高亮 + Markdown + 主题切换 + 大文件支持 | 插件接口 stub              | ❌           | Rust + Tauri + CodeMirror 6 |
| **v0.5** | 自动语言识别 + 实时 Markdown 预览                    | 内部插件接口测试               | ❌           | 同上                          |
| **v1**   | 稳定内核 + 核心插件 API 完整                         | 官方插件（LSP、Debug、Git、AI） | ✅ 自动升级      | 同上                          |
| **v1.5** | 内核优化                                       | 第三方插件支持                | ✅ 插件市场上线    | 同上                          |

---

✅ **总结**：

* 内核保证开箱即用，可替代 Notepad
* 彩色代码 + Markdown + 主题 + 插件接口为核心
* 在线升级和插件市场为后续扩展，分阶段实现
* 跨平台设计已纳入功能清单，技术栈明确
* 文档可直接用于 Agent 或开发团队指导开发

---

